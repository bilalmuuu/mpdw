---
title: "Tugas Praktikum 4 MPDW"
author: "Bilal Muhammad Thalib (G1401231093)"
date: "2025-09-22"
output: html_document
---

# Bangkitkan model MA(2) dengan θ1=0.4 dan θ2=0.6 sebanyak 300 data (Manual dan dengan arima.sim)

## Membangkitkan Data secara manual

```{r}
set.seed(1234)
n <- 300
wn <- rnorm(n)

ma2_manual <- rep(0, n)
ma2_manual[1:2] <- wn[1:2]

for(i in 3:n){
  ma2_manual[i] <- wn[i] + 0.4*wn[i-1] + 0.6*wn[i-2]
}
ma2_manual
```

## Membangkitkan Data dengan arima.sim

```{r}
ma2_sim <- arima.sim(list(order=c(0,0,2), ma=c(0.4, 0.6)), n=n)
ma2_sim
```

## Karakteristik MA(2)

### Plot Time Series

```{r}
ts.plot(ma2_manual, main="Manual MA(2)")
```

```{r}
ts.plot(ma2_sim, main="arima.sim MA(2)")
```

Berdasarkan plot time series di atas, dapat dilihat bahwa data MA(2) yang sudah dibangkitkan melalui cara manual / arima.sim merupakan data yang stasioner pada rataan.

### Plot ACF

```{r}
acf(ma2_manual, lag.max=20, main="ACF MA(2)")
```

Berdasarkan plot AFC di atas, dapat dilihat bahwa plot ACF terdapat cuts off di "lag ketiga"

### Plot PACF

```{r}
pacf(ma2_manual, lag.max=20, main="PACF MA(2)")
```

Berdasarkan plot PACF di atas, dapat dilihat bahwa plot PACF cenderung tails off dan membentuk gelombang sinus.

### Plot EACF

```{r}
TSA::eacf(ma2_manual)
```

Berdasarkan pola segitiga nol pada plot EACF di atas, dapat dilihat bahwa segitiga nol berada pada ordo AR(0) dan ordo MA(2)

### Scatterplot Antar Lag

*Korelasi antara Yt dengan Yt−1*

```{r}
yt <- ma2_manual[-1]
yt_1 <- ma2_manual[-n]
plot(x=yt_1, y=yt, main="Yt vs Yt-1")
```

```{r}
cor(yt, yt_1)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi (0.5274606) mendekati perhitungan teoritis yaitu 0.4211  

\[
\rho_1 = \frac{0.64}{1.52} = 0.4211
\]

*Korelasi antara Yt dengan Yt−2*

```{r}
yt2 <- ma2_manual[-c(1,2)]
yt_2 <- ma2_manual[-c((n-1), n)]
plot(x=yt_2, y=yt2, main="Yt vs Yt-2")
```

```{r}
cor(yt2, yt_2)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi (0.4339293) mendekati perhitungan teoritis yaitu 0.3947

\[
\rho_2 = \frac{0.60}{1.52} = 0.3947
\]

*Korelasi antara Yt dengan Yt−3*

```{r}
yt3 <- ma2_manual[-c(1,2,3)]
yt_3 <- ma2_manual[-c((n-2), (n-1), n)]
plot(x=yt_3, y=yt3, main="Yt vs Yt-3")
```

```{r}
cor(yt3, yt_3)
```

Korelasi antara $Y_t$ dengan $Y_{t-3}$ dari hasil simulasi (0.08555282) mendekati perhitungan teoritis yaitu 0

\[
\rho_3 = 0
\]

### Autokorelasi

Perhitungan Secara Teoritis

```{r}
acf(ma2_manual, lag.max=10, plot=FALSE)$acf
```

```{r}
acf(ma2_sim, lag.max=10, plot=FALSE)$acf
```

# Bangkitkan model AR(2) dengan 𝜙1 = 0.5 dan 𝜙2 = 0.2 sebanyak 300 data (Manual dan dengan arima.sim)

## Membangkitkan Data secara manual

```{r}
set.seed(1234)
n <- 300
wn <- rnorm(n)
ar2_manual <- rep(0, n)
ar2_manual[1:2] <- wn[1:2]
for(i in 3:n){
  ar2_manual[i] <- 0.5*ar2_manual[i-1] + 0.2*ar2_manual[i-2] + wn[i]
}
ar2_manual
```

## Membangkitkan Data dengan arima.sim

```{r}
ar2_sim <- arima.sim(list(order=c(2,0,0), ar=c(0.5, 0.2)), n=n)
ar2_sim
```

## Karakteristik AR(2)

### Plot Time Series

```{r}
ts.plot(ar2_manual, main="Manual AR(2)")
```

```{r}
ts.plot(ar2_sim, main="arima.sim AR(2)")
```

Berdasarkan plot time series di atas, dapat dilihat bahwa data MA(2) yang sudah dibangkitkan melalui cara manual / arima.sim merupakan data yang stasioner pada rataan.

### Plot ACF

```{r}
acf(ar2_manual, lag.max=20, main="ACF AR(2)")
```

Berdasarkan plot PACF di atas, dapat dilihat bahwa plot PACF cenderung tails off dan membentuk gelombang sinus.

### Plot PACF

```{r}
pacf(ar2_manual, lag.max=20, main="PACF AR(2)")
```

Berdasarkan plot AFC di atas, dapat dilihat bahwa plot ACF terdapat cuts off di "lag kedua"

### Plot EACF

```{r}
TSA::eacf(ar2_manual)
```

Berdasarkan pola segitiga nol pada plot EACF di atas, dapat dilihat bahwa segitiga nol berada pada ordo AR(2) dan ordo MA(0)

### Scatterplot Antar Lag

*Korelasi antara Yt dengan Yt−1*

```{r}
yt_ar <- ar2_manual[-1]
yt_1_ar <- ar2_manual[-n]
plot(x=yt_1_ar, y=yt_ar, main="Yt vs Yt-1")
```

```{r}
cor(yt_ar, yt_1_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu 
$\rho_1 = \phi^1 = 0.625$

*Korelasi antara Yt dengan Yt−2*

```{r}
yt2_ar <- ar2_manual[-c(1,2)]
yt_2_ar <- ar2_manual[-c((n-1), n)]
plot(x=yt_2_ar, y=yt2_ar, main="Yt vs Yt-2")
```

```{r}
cor(yt2_ar, yt_2_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu 
$\rho_1 = \phi^1 = 0.5125$

*Korelasi antara Yt dengan Yt−3*

```{r}
yt3_ar <- ar2_manual[-c(1,2,3)]
yt_3_ar <- ar2_manual[-c((n-2), (n-1), n)]
plot(x=yt_3_ar, y=yt3_ar, main="Yt vs Yt-3")
```

```{r}
cor(yt3_ar, yt_3_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu 
$\rho_1 = \phi^1 = 0.38125$

### Autokorelasi

```{r}
acf(ar2_manual, lag.max=10, plot=FALSE)$acf
```

```{r}
acf(ar2_sim, lag.max=10, plot=FALSE)$acf
```

# Bangkitkan model ARMA(2,2) dengan 𝜃1 = 0.4, 𝜃2 = 0.6 ,𝜙1 = 0.5 dan 𝜙2 = 0.2 sebanyak 300 data (Manual dan arima.sim)

## Membangkitkan Data secara manual

```{r}
set.seed(1234)
n <- 300
wn <- rnorm(n)
arma22_manual <- rep(0, n)
arma22_manual[1:2] <- wn[1:2]
for(i in 3:n){
  arma22_manual[i] <- 0.5*arma22_manual[i-1] + 0.2*arma22_manual[i-2] + wn[i] + 0.4*wn[i-1] + 0.6*wn[i-2]
}
arma22_manual
```

## Membangkitkan Data dengan arima.sim

```{r}
arma22_sim <- arima.sim(list(order=c(2,0,2), ar=c(0.5, 0.2), ma=c(0.4, 0.6)), n=n)
arma22_sim
```

## Karakteristik ARMA(2,2)

### Plot Time Series

```{r}
ts.plot(arma22_manual, main="Manual ARMA(2,2)")
```

```{r}
ts.plot(arma22_sim, main="arima.sim ARMA(2,2)")
```

Berdasarkan plot time series di atas, dapat dilihat bahwa model ARMA(2, 2) yang sudah dibangkitkan melalui cara manual / arima.sim merupakan data yang stasioner pada rataan.

### Plot ACF

```{r}
acf(arma22_manual, lag.max=20, main="ACF ARMA(2,2)")
```

```{r}
acf(arma22_sim, lag.max=20, main="ACF ARMA(2,2) - arima.sim")
```

Berdasarkan plot ACF di atas, dapat dilihat bahwa Nodel ARMA(2, 2) cenderung tails off dan membentuk gelombang sinus.

### Plot PACF

```{r}
pacf(arma22_manual, lag.max=20, main="PACF ARMA(2,2)")
```

```{r}
pacf(arma22_sim, lag.max=20, main="PACF ARMA(2,2) - arima.sim")
```

Berdasarkan plot PACF di atas, dapat dilihat bahwa Nodel ARMA(2, 2) cenderung tails off dan membentuk gelombang sinus.

### Plot EACF

```{r}
TSA::eacf(arma22_manual)
```

```{r}
TSA::eacf(arma22_sim)
```

### Scatterplot Antar Lag

*Korelasi antara Yt dengan Yt−1*

```{r}
yt_arma <- arma22_manual[-1]
yt_1_arma <- arma22_manual[-n]
plot(x=yt_1_arma, y=yt_arma, main="Yt vs Yt-1")
```

```{r}
cor(yt_arma, yt_1_arma)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi (0.8946787) mendekati perhitungan teoritis yaitu 

\[
\rho_1 = 0.8592
\]

*Korelasi antara Yt dengan Yt−2*

```{r}
yt2_arma <- arma22_manual[-c(1,2)]
yt_2_arma <- arma22_manual[-c((n-1), n)]
plot(x=yt_2_arma, y=yt2_arma, main="Yt vs Yt-2")
```

```{r}
cor(yt2_arma, yt_2_arma)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi (0.78822) mendekati perhitungan teoritis yaitu 

\[
\rho_2 = 0.7492
\]

*Korelasi antara Yt dengan Yt−3*

```{r}
yt3_arma <- arma22_manual[-c(1,2,3)]
yt_3_arma <- arma22_manual[-c((n-2), (n-1), n)]
plot(x=yt_3_arma, y=yt3_arma, main="Yt vs Yt-3")
```

```{r}
cor(yt3_arma, yt_3_arma)
```

Korelasi antara $Y_t$ dengan $Y_{t-3}$ dari hasil simulasi (0.6177423) mendekati perhitungan teoritis yaitu 

\[
\rho_3 = 0.5464
\]

### Autokorelasi

```{r}
acf(arma22_manual, lag.max=10, plot=FALSE)$acf
```


```{r}
acf(arma22_sim, lag.max=10, plot=FALSE)$acf
```